<!DOCTYPE html>
<html
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{layouts/layout}"
        lang="en"
>
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
            crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

</head>
<div layout:fragment="content">

    <div>
        <h3>홍보 게시판</h3>
    </div>
    <div class="dropdownContainer" style="display: flex; margin-bottom: 50px;">
        <div class="dropdown"><!-- 지역 선택 드롭다운 -->
            <label for="promoBrdRegion"></label>
            <select name="districts" id="promoBrdRegion" onchange="updateData()">
                <option value="none">지역 선택</option>
                <option value="중구">중구</option>
                <option value="서구">서구</option>
                <option value="동구">동구</option>
                <option value="영도구">영도구</option>
                <option value="부산진구">부산진구</option>
                <option value="동래구">동래구</option>
                <option value="남구">남구</option>
                <option value="북구">북구</option>
                <option value="강서구">강서구</option>
                <option value="해운대구">해운대구</option>
                <option value="사하구">사하구</option>
                <option value="금정구">금정구</option>
                <option value="연제구">연제구</option>
                <option value="수영구">수영구</option>
                <option value="사상구">사상구</option>
                <option value="기장군">기장군</option>
            </select>

            <div id="result"></div>

        </div>
        <!-- 게시글 유형 드롭다운 -->
        <div class="dropdown"><!-- 지역 선택 드롭다운 -->
            <label for="promoBrdCategory"></label>
            <select name="categorys" id="promoBrdCategory" onchange="updateData()">
                <option value="none">게시글 유형</option>
                <option value="중구">체험</option>
                <option value="서구">이벤트</option>
                <option value="서구">일반</option>
            </select>
            <div id="result2"></div>
        </div>

        <div class="promoWrite"><!-- 글쓰기 버튼 -->

        </div>
    </div>

    <!-- 여기서 부터 홍보 카드가 나타난다. 데이터 받아서 한 페이지당 8개의 카드가 나타나게 페이징처리. -->
    <div class="cardContainer"  style="display:flex;"><!-- 홍보 이미지 -->
        <div class="cardBox" th:each="promotions : ${promotions}" style="display:flex;">
            <div class="row row-cols-1 row-cols-md-4 g-4" style="display:flex;">
                <div class="col" >
                    <div class="card" style="width: 300px; height: 300px; ">
                        <img th:src="${promotions.promoBrdMainImg}" class="card-img-top img-fluid" alt="홍보 이미지" style="object-fit: cover; object-position: top; width: 100%; height: 65%;">
                        <!-- 대표 이미지 받기 -->
                        <div class="card-body">
                            <h5 class="card-title"><span th:text="${promotions.promoBrdTitle}"></span></h5>
                            <!-- 여기서부터 날자를 받아야 된다. 어떤 날자의 데이터가 들어오는지에 따라서 상태 표시 박스가 변하고 데이터가 없으면 보여주지 않아야 한다. -->
                            <!--                            <div class="card-EventstartDate"><span th:text="${promotions.promoBrdEventStartDate"></span></div>-->
                            <div class="card-EventEndDate"><span th:text="${promotions.promoBrdEventEndDate}"></span>
                            </div><!--일반인 경우 보이지 않음.-->
                            <div class="card-BusinessName"><span th:text="${promotions.promoBrdBusinessName}"></span>
                            </div>
                            <div class="card-Participants"></div>
                            <!--                            <div class="card-ApplyParticipants" style="">-->
                            <span th:text="${promotions.promoBrdApplyParticipants}"></span><!--일반인 경우 보이지 않음.-->
                            <!--                            </div>-->
                            /<!--일반인 경우 보이지 않음.-->
                            <!--                            <div class="card-MaxParticipants">-->
                            <span th:text="${promotions.promoBrdMaxParticipants}"></span><!--일반인 경우 보이지 않음.-->
                            <!--                            </div>-->

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <div class="promoPaging"> <!-- 페이징 처리 -->

        </div>
        <div class="promoWrite"> <!-- 글쓰기 버튼 -->

        </div>
    </div>
    <div>
        <div> <!-- 검색 제목 + 내용 -->

        </div>
        <div> <!-- 검색 텍스트 입력창 -->

        </div>
        <div> <!-- 검색 버튼 -->

        </div>
    </div>
    <script>
                function updateData() {
                    var selectedDistrict = $("#promoBrdRegion").val();
                    var selectedCategory = $("#promoBrdCategory").val();

                    $.ajax({
                        type: "GET",
                        url: "/promotion?promoBrdRegion=" + selectedDistrict + "&promoBrdCategory=" + selectedCategory,
                        data: {
                            promoBrdRegion: selectedDistrict,
                            promoBrdCategory: selectedCategory
                        },
                        success: function(data) {
                            $("#result").html(data);
                        },
                        error: function(xhr, status, error) {
                            console.error("Error while fetching data: ", error);
                        }
                    });
                }

        <!--        // 현재 날짜를 가져오는 함수-->
        <!--        function getCurrentDate() {-->
        <!--            var currentDate = new Date();-->
        <!--            var year = currentDate.getFullYear();-->
        <!--            var month = currentDate.getMonth() + 1; // 월은 0부터 시작하므로 1을 더해줍니다.-->
        <!--            var day = currentDate.getDate();-->

        <!--            // 날짜 형식을 'yyyy-MM-dd'로 조정-->
        <!--            return year + "-" + (month < 10 ? "0" + month : month) + "-" + (day < 10 ? "0" + day : day);-->
        <!--        }-->

        <!--        // 화면 로딩 시 실행되는 함수-->
        <!--        $(document).ready(function () {-->
        <!--            // 모든 홍보 카드에 대해 반복-->
        <!--            $(".card-EventEndDate").each(function () {-->
        <!--                // 카드의 날짜를 가져옴-->
        <!--                var cardDate = $(this).find("span").text();-->

        <!--                // 현재 날짜와 카드의 날짜를 비교-->
        <!--                if (getCurrentDate() > cardDate) {-->
        <!--                    // 현재 날짜 이후인 경우, 보이지 않게 처리-->
        <!--                    $(this).closest(".card").hide();-->
        <!--                }-->
        <!--            });-->
        <!--        });-->

    </script>
</div>
<!-- re push -->


</html>
